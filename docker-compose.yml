version: '3.9'

# Volumes are the preferred mechanism for persisting data
# generated by and used by Docker containers.

# While bind mounts are dependent on the directory structure
# and OS of the host machine, volumes are completely managed by Docker.

# A volume does not increase the size of the containers using it. 
# The volumeâ€™s contents exist outside the lifecycle of a given container.
volumes:
  WordPress:
    name: WordPress_v
    driver: local
  MariaDB:
    name: MariaDB_v
    driver: local
  


services:
  mariadb:
    container_name: mariadb_c
    build:
      context: ./mariadb/
    env_file: # environment variables, that are passed to the image
      - .env
    depends_on:
      - nginx
    volumes:
      - MariaDB:/var/lib/mysql

  nginx:
    container_name: nginx_c
    build:
      context: ./nginx/
    ports: # mapping public port 443 to port 443 thats running for nginx in conatiner (specified in nginx config)
      - 443:443
    volumes:
      - WordPress:/var/www/html

  wordpress:
    container_name: wordpress_c
    build:
      context: ./wordpress/
    env_file: # environment variables, that are passed to the image
      - .env
    depends_on:
      - mariadb
    volumes:
      - WordPress:/var/www/html

